"use strict";(()=>{var e={};e.id=17,e.ids=[17],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},1739:(e,o,t)=>{t.r(o),t.d(o,{originalPathname:()=>m,patchFetch:()=>f,requestAsyncStorage:()=>d,routeModule:()=>u,serverHooks:()=>g,staticGenerationAsyncStorage:()=>h});var n={};t.r(n),t.d(n,{POST:()=>p,maxDuration:()=>l});var s=t(9303),r=t(8716),a=t(670),i=t(7070);let l=10,c={ai:"AI应用开发",enterprise:"企业管理系统",web:"网站开发",mobile:"移动应用",consulting:"技术咨询",other:"其他"};async function p(e){console.log("[API] Consultation form submission started");try{let o=await e.json();if(console.log("[API] Received data:",{...o,phone:"***"}),!o.name||!o.phone||!o.projectType)return console.log("[API] Validation failed: missing required fields"),i.NextResponse.json({error:"缺少必填字段"},{status:400});if(!/^1[3-9]\d{9}$/.test(o.phone))return console.log("[API] Validation failed: invalid phone number"),i.NextResponse.json({error:"手机号格式不正确"},{status:400});let t=c[o.projectType]||o.projectType,n=new Date().toLocaleString("zh-CN",{timeZone:"Asia/Shanghai"}),s=process.env.WECHAT_WEBHOOK_URL;if(console.log("[API] Webhook URL configured:",s?"Yes":"No"),!s)return console.error("[API] 未配置企业微信Webhook URL"),i.NextResponse.json({success:!0});let r={msgtype:"markdown",markdown:{content:`## 📋 新客户咨询
> **来源：** 智理科技官网

**👤 客户姓名：** <font color="info">${o.name}</font>
**📱 联系电话：** <font color="warning">${o.phone}</font>
**💼 项目类型：** ${t}
**📝 需求描述：** ${o.message||"暂无"}
**🌐 语言环境：** ${o.locale}
**⏰ 提交时间：** ${n}

> 请尽快联系客户！`}};console.log("[API] Sending to WeChat webhook...");let a=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}),l=await a.text();return console.log("[API] WeChat response status:",a.status),console.log("[API] WeChat response:",l),a.ok?console.log("[API] WeChat notification sent successfully"):console.error("[API] 企业微信通知发送失败:",l),i.NextResponse.json({success:!0})}catch(e){return console.error("[API] 处理咨询表单失败:",e),i.NextResponse.json({error:"服务器错误"},{status:500})}}let u=new s.AppRouteRouteModule({definition:{kind:r.x.APP_ROUTE,page:"/api/consultation/route",pathname:"/api/consultation",filename:"route",bundlePath:"app/api/consultation/route"},resolvedPagePath:"/Users/a111/Desktop/code/devWeb/app/api/consultation/route.ts",nextConfigOutput:"standalone",userland:n}),{requestAsyncStorage:d,staticGenerationAsyncStorage:h,serverHooks:g}=u,m="/api/consultation/route";function f(){return(0,a.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:h})}}};var o=require("../../../webpack-runtime.js");o.C(e);var t=e=>o(o.s=e),n=o.X(0,[948,972],()=>t(1739));module.exports=n})();